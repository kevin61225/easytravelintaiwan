@{
    ViewBag.Title = "Easy Travel In Taiwan - 路線規劃";
}

<style>
    #map_canvas {
        height: 400px;
        width: 90%;
    }
</style>

<!--引入 Google API-->
<script src="https://maps.googleapis.com/maps/api/js?v=3.9&sensor=false"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>

<div id="map_canvas" class="cus_canvas"></div>

<script type="text/javascript">

    var directionsService = new google.maps.DirectionsService();
    var map;
    var start = "台中市西區五權路50號";
    var end = "台中市體育場";
    var waypoints = "台中市南區復興路四段50號,台中市西區公館路50號";

    //初始化
    function initialize() {
        //規畫路徑呈現選項
        var rendererOptions = {
            suppressMarkers: true,
            draggable: true
        };

        directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);
        var startPoint = new google.maps.LatLng(24.136845, 120.685009);
        var myOptions = {
            zoom: 14,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            center: startPoint
        }
        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        directionsDisplay.setMap(map);
    }

    //規畫路徑
    function calcRoute() {
        if (!waypoints) return;

        var arrPoint = waypoints.split(",");

        //經過地點
        var waypts = [];
        for (var i = 0; i < arrPoint.length; i++) {
            waypts.push({
                location: arrPoint[i],
                stopover: true
            });
        }

        //規畫路徑請求
        var request = {
            origin: start,
            destination: end,
            waypoints: waypts,
            optimizeWaypoints: true,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };

        directionsService.route(request, function (response, status) {
            //規畫路徑回傳結果
            if (status == google.maps.DirectionsStatus.OK) {
                directionsDisplay.setDirections(response);
            }
        });
    }

    google.maps.event.addDomListener(window, 'load', initialize);
    google.maps.event.addDomListener(window, 'load', calcRoute);
</script>
